{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "workspace": {
            "type": "String"
        }
    },
    "resources": [
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/BuiltInFusion')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/BuiltInFusion')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Fusion",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "enabled": true,
                "alertRuleTemplateName": "f71aba3d-28fb-450b-b192-4e76a83015c8"
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/f209187f-1d17-4431-94af-c141bf5f23db')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/f209187f-1d17-4431-94af-c141bf5f23db')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "f209187f-1d17-4431-94af-c141bf5f23db",
                "displayName": "(Preview) Anomalous Account Creation",
                "enabled": true,
                "tactics": [
                    "Persistence"
                ],
                "anomalyVersion": "1.0.0",
                "techniques": [
                    "T1136"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.4",
                            "name": "Anomaly score threshold",
                            "description": "Generate an anomaly when the anomaly score is greater than the chosen value.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/2d3e33c6-d8e6-4b51-92d6-dbe8bd9efb05')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/2d3e33c6-d8e6-4b51-92d6-dbe8bd9efb05')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "2d3e33c6-d8e6-4b51-92d6-dbe8bd9efb05",
                "displayName": "(Preview) Anomalous Azure AD sign-in sessions",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.0.4",
                "techniques": [
                    "T1078",
                    "T1566",
                    "T1133"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": [
                        {
                            "supportedValues": [
                                "Fraction of failed signins",
                                "Number of failed signins",
                                "Failed signins to successful signins ratio",
                                "Number of signins with incorrect passwords",
                                "Incorrect passwords to correct passwords ratio",
                                "Fraction of incorrect password signins",
                                "Distinct number of app ids",
                                "Distinct number of client apps",
                                "Distinct number of ip addresses",
                                "Distinct number of opperating systems",
                                "Distinct number of browsers",
                                "Distinct number of cities",
                                "Distinct number of states",
                                "Distinct number of countries"
                            ],
                            "values": [
                                "Fraction of failed signins",
                                "Number of failed signins",
                                "Failed signins to successful signins ratio",
                                "Number of signins with incorrect passwords",
                                "Incorrect passwords to correct passwords ratio",
                                "Fraction of incorrect password signins",
                                "Distinct number of app ids",
                                "Distinct number of client apps",
                                "Distinct number of ip addresses",
                                "Distinct number of opperating systems",
                                "Distinct number of browsers",
                                "Distinct number of cities",
                                "Distinct number of states",
                                "Distinct number of countries"
                            ],
                            "supportedValuesKql": null,
                            "valuesKql": null,
                            "name": "Top reason for high anomaly score",
                            "description": "Include only anomalies where the top reason is one of these values.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0.0",
                            "maximum": "1.0",
                            "value": "0.5",
                            "name": "Score",
                            "description": "Generate an anomaly when the anomaly score is greater than or equal to the chosen value.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/8595d264-2f64-442d-b293-4e16dffc9882')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/8595d264-2f64-442d-b293-4e16dffc9882')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "8595d264-2f64-442d-b293-4e16dffc9882",
                "displayName": "(Preview) Anomalous Code Execution",
                "enabled": true,
                "tactics": [
                    "Execution"
                ],
                "anomalyVersion": "1.0.0",
                "techniques": [
                    "T1059"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0",
                            "name": "Anomaly score threshold",
                            "description": "Generate an anomaly when the anomaly score is greater than the chosen value.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/c5644575-4982-4a07-8884-b11ec2866dc3')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/c5644575-4982-4a07-8884-b11ec2866dc3')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "c5644575-4982-4a07-8884-b11ec2866dc3",
                "displayName": "(Preview) Anomalous local account creation",
                "enabled": true,
                "tactics": [
                    "Persistence"
                ],
                "anomalyVersion": "1.0.0",
                "techniques": [
                    "T1136"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": [
                        {
                            "prioritize": null,
                            "exclude": "srcdomain1\\account1, srcdomain1\\account1",
                            "dataType": "string",
                            "name": "Source user allowlist",
                            "description": "Enter comma separated source usernames to be suppressed while triggering anomalies. This should be within double quotes and is case sensitive, example: \"srcdomain1\\\\account1, srcdomain2\\\\account2\"",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        },
                        {
                            "prioritize": null,
                            "exclude": "account1, account2",
                            "dataType": "string",
                            "name": "Destination user allowlist",
                            "description": "Enter comma separated destination usernames to be suppressed while triggering anomalies. This should be within double quotes and is case sensitive, example: \"account1, account2\"",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "thresholdObservations": null,
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/2bb167bf-3951-435b-a932-8b03bfde0a2b')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/2bb167bf-3951-435b-a932-8b03bfde0a2b')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "2bb167bf-3951-435b-a932-8b03bfde0a2b",
                "displayName": "(Preview) Anomalous scanning activity",
                "enabled": true,
                "tactics": [
                    "Discovery"
                ],
                "anomalyVersion": "1.0.3",
                "techniques": [
                    "T1046"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": [
                        {
                            "supportedValues": [
                                "accept",
                                "allow",
                                "start"
                            ],
                            "values": [
                                "accept",
                                "allow",
                                "start"
                            ],
                            "supportedValuesKql": null,
                            "valuesKql": null,
                            "name": "Device action",
                            "description": "Include only these specific device actions",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": [
                        {
                            "prioritize": null,
                            "exclude": "53,67,80,8080,123,137,138,443,445,3389",
                            "dataType": "string",
                            "name": "Exclude ports",
                            "description": "Provide a comma separated list to exclude specific ports from source data. This should be within double quotes, example: \"53, 67, 80, 8080, 123, 137, 138, 443, 445, 3389\"",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "thresholdObservations": [
                        {
                            "minimum": "1",
                            "maximum": "60000000",
                            "value": "600",
                            "name": "Destination IP count",
                            "description": "The minimum distinct destination IP count per hour required for inclusion. Default is 600. This is an OR condition with destination port count.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "1",
                            "maximum": "60000000",
                            "value": "600",
                            "name": "Destination port count",
                            "description": "The minimum distinct destination port count per hour required for inclusion. Default is 600. This is an OR condition with destination IP count.",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "0.00",
                            "maximum": "1.00",
                            "value": "1.00",
                            "name": "IP ratio",
                            "description": "The distinct source IP (always 1) to distinct destination IP count with a default minimum ratio of 1.00 or lower (converted to Base 10 to the -4 power of original value). This is an OR condition with port ratio.",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "0.00",
                            "maximum": "1.00",
                            "value": "1.00",
                            "name": "Port ratio",
                            "description": "The distinct source port to distinct destination port count with a default minimum ratio of 1.00 or lower (converted to Base 10 to the -4 power of original value). This is an OR condition with IP Ratio.",
                            "sequenceNumber": 3,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/bb32dc8a-4f6b-4274-a28f-50f3400070b4')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/bb32dc8a-4f6b-4274-a28f-50f3400070b4')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "bb32dc8a-4f6b-4274-a28f-50f3400070b4",
                "displayName": "(Preview) Anomalous Sign In",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.0.1",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.2",
                            "name": "Anomaly score threshold",
                            "description": "Generate an anomaly when the anomaly score is greater than the chosen value.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/16d55bbb-8c54-4c1d-8537-521824e76bb6')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/16d55bbb-8c54-4c1d-8537-521824e76bb6')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "16d55bbb-8c54-4c1d-8537-521824e76bb6",
                "displayName": "(Preview) Anomalous user activities in Office Exchange",
                "enabled": true,
                "tactics": [
                    "Collection",
                    "Persistence"
                ],
                "anomalyVersion": "1.0.2",
                "techniques": [
                    "T1114",
                    "T1213",
                    "T1098",
                    "T1136",
                    "T1137",
                    "T1505",
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": [
                        {
                            "supportedValues": [
                                "Distinct number of operations",
                                "Distinct number of ClientInfoString",
                                "Distinct number of mailboxes",
                                "Number of operations",
                                "Distinct number of IP addresses",
                                "Distinct number of /24 subnets",
                                "Distinct number of /16 subnets",
                                "Number of MessageBind operations",
                                "Number of FolderBind operations",
                                "Number of UpdateInboxRules operations",
                                "Number of MailItemsAccessed operations"
                            ],
                            "values": [
                                "Distinct number of operations",
                                "Distinct number of ClientInfoString",
                                "Distinct number of mailboxes",
                                "Number of operations",
                                "Distinct number of IP addresses",
                                "Distinct number of /24 subnets",
                                "Distinct number of /16 subnets",
                                "Number of MessageBind operations",
                                "Number of FolderBind operations",
                                "Number of UpdateInboxRules operations",
                                "Number of MailItemsAccessed operations"
                            ],
                            "supportedValuesKql": null,
                            "valuesKql": null,
                            "name": "Top reason for high anomaly score",
                            "description": "Include only anomalies where the top reason is one of these values.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0.0",
                            "maximum": "1.0",
                            "value": "0.6",
                            "name": "Score",
                            "description": "Generate an anomaly when the anomaly score is greater than or equal to the chosen value.",
                            "sequenceNumber": 0,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/8a12afde-ed27-46ac-a5ef-392e3d4f071f')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/8a12afde-ed27-46ac-a5ef-392e3d4f071f')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "8a12afde-ed27-46ac-a5ef-392e3d4f071f",
                "displayName": "(Preview) Anomalous W3CIIS logs activity",
                "enabled": true,
                "tactics": [
                    "InitialAccess",
                    "Persistence"
                ],
                "anomalyVersion": "1.0.0",
                "techniques": [
                    "T1190",
                    "T1505"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": [
                        {
                            "supportedValues": [
                                "1",
                                "2",
                                "3"
                            ],
                            "supportedValuesKql": null,
                            "value": "3",
                            "name": "Number of reasons for anomalous activity",
                            "description": "Provide explanations for the specified number of reasons why a W3CIIS session is anomalous.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        },
                        {
                            "supportedValues": [
                                "Distinct number of methods",
                                "Distinct number of uri queries",
                                "Distinct number of uri stems",
                                "Distinct number of statuses",
                                "Distinct number of user agents",
                                "Total number of operations",
                                "Total number of http verbs",
                                "Total number of http statuses",
                                "None"
                            ],
                            "supportedValuesKql": null,
                            "value": "None",
                            "name": "Display anomalies for a specific top reason",
                            "description": "Display anomalies only where the top reason is specified in the checklist.",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        },
                        {
                            "supportedValues": [
                                "Public IPs",
                                "Private IPs",
                                "All IPs"
                            ],
                            "supportedValuesKql": null,
                            "value": "All IPs",
                            "name": "Display anomalies for public, private, or all IPs",
                            "description": "Choose to display anomalies for public, private, or all IPs.",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "prioritizeExcludeObservations": [
                        {
                            "prioritize": null,
                            "exclude": null,
                            "dataType": "string",
                            "name": "Exclude client IPs from the anomalies generated",
                            "description": "Enter comma separated client IPs (prefixed client IP entities supported) that the anomalies should not display results for, in the exclude field.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "thresholdObservations": [
                        {
                            "minimum": "0.0",
                            "maximum": "1.0",
                            "value": "0.7",
                            "name": "Score",
                            "description": "Generate an anomaly when the anomaly score is greater than or equal to the chosen value.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/edc946ae-cba8-419f-8e90-309966895956')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/edc946ae-cba8-419f-8e90-309966895956')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "edc946ae-cba8-419f-8e90-309966895956",
                "displayName": "(Preview) Anomalous web request activity",
                "enabled": true,
                "tactics": [
                    "InitialAccess",
                    "Persistence"
                ],
                "anomalyVersion": "1.0.2",
                "techniques": [
                    "T1190",
                    "T1505"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": [
                        {
                            "supportedValues": [
                                "Include regularly repeating anomalies for URI stems",
                                "Exclude regularly repeating anomalies for URI stems"
                            ],
                            "supportedValuesKql": null,
                            "value": "Exclude regularly repeating anomalies for URI stems",
                            "name": "Handle regularly repeating anomalies for URI stems",
                            "description": "Choose to exclude URI stems that have been regularly occuring in the Anomalies table in Log Analytics.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "prioritizeExcludeObservations": [
                        {
                            "prioritize": ".asp, .aspx, .armx, .asax, .ashz, .asmx, .axd, .cshtml, .php, .phps, .php3, .php4, .php5, .php7, .jsp, .jspx, .cfm, .cfml, .phtml",
                            "exclude": null,
                            "dataType": "string",
                            "name": "Prioritize script suffixes of the URI stems",
                            "description": "Give comma separated script suffixes of the URI stems that should be included in the prioritize field.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        },
                        {
                            "prioritize": null,
                            "exclude": "",
                            "dataType": "string",
                            "name": "Exclude noisy URI stems",
                            "description": "Give comma separated URI stems that are frequently observing noisy sessions, and should be excluded from the Anomalies table in Log Analytics.",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "thresholdObservations": [
                        {
                            "minimum": "0.0",
                            "maximum": "1.0",
                            "value": "0.2",
                            "name": "Score",
                            "description": "Generate an anomaly when the anomaly score is greater than or equal to the chosen value.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/8a602940-4153-4045-a741-3bf15591ae29')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/8a602940-4153-4045-a741-3bf15591ae29')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "8a602940-4153-4045-a741-3bf15591ae29",
                "displayName": "(Preview) Attempted computer bruteforce",
                "enabled": true,
                "tactics": [
                    "CredentialAccess"
                ],
                "anomalyVersion": "1.2.6",
                "techniques": [
                    "T1110"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.4",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/ffe3625d-a933-4f63-b192-7e6ebf3be5fb')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/ffe3625d-a933-4f63-b192-7e6ebf3be5fb')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "ffe3625d-a933-4f63-b192-7e6ebf3be5fb",
                "displayName": "(Preview) Attempted user account bruteforce",
                "enabled": true,
                "tactics": [
                    "CredentialAccess"
                ],
                "anomalyVersion": "1.2.6",
                "techniques": [
                    "T1110"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.1",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/93c4b361-ea7d-40f4-9ca6-e501cdef9c53')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/93c4b361-ea7d-40f4-9ca6-e501cdef9c53')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "93c4b361-ea7d-40f4-9ca6-e501cdef9c53",
                "displayName": "(Preview) Attempted user account bruteforce per failure reason",
                "enabled": true,
                "tactics": [
                    "CredentialAccess"
                ],
                "anomalyVersion": "1.1.4",
                "techniques": [
                    "T1110"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": [
                        {
                            "supportedValues": [
                                "\\%%2305-The specified user account has expired",
                                "\\%%2309-The specified account's password has expired",
                                "\\%%2310-Account currently disabled",
                                "\\%%2311-Account logon time restriction violation",
                                "\\%%2312-User not allowed to logon at this computer",
                                "\\%%2313-Unknown user name or bad password",
                                "\\%%2307-Account locked out",
                                "\\%%2304-An Error occurred during Logon"
                            ],
                            "values": [
                                "\\%%2305-The specified user account has expired",
                                "\\%%2309-The specified account's password has expired",
                                "\\%%2310-Account currently disabled",
                                "\\%%2311-Account logon time restriction violation",
                                "\\%%2312-User not allowed to logon at this computer",
                                "\\%%2313-Unknown user name or bad password",
                                "\\%%2307-Account locked out",
                                "\\%%2304-An Error occurred during Logon"
                            ],
                            "supportedValuesKql": null,
                            "valuesKql": null,
                            "name": "Failure Reasons",
                            "description": "Include only selected failure reasons in anomaly results.",
                            "sequenceNumber": 0,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.3",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/c097bfdb-8b4b-4a98-b74d-1871ffd50a03')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/c097bfdb-8b4b-4a98-b74d-1871ffd50a03')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "c097bfdb-8b4b-4a98-b74d-1871ffd50a03",
                "displayName": "(Preview) Attempted user account bruteforce per logon type",
                "enabled": true,
                "tactics": [
                    "CredentialAccess"
                ],
                "anomalyVersion": "1.0.4",
                "techniques": [
                    "T1110"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": [
                        {
                            "supportedValues": [
                                "2-Interactive",
                                "3-Network",
                                "4-Batch",
                                "5-Service",
                                "7-Unlock",
                                "8-NetworkCleartext",
                                "9-NewCredentials",
                                "10-RemoteInteractive",
                                "11-CachedInteractive"
                            ],
                            "values": [
                                "2-Interactive",
                                "3-Network",
                                "4-Batch",
                                "5-Service",
                                "7-Unlock",
                                "8-NetworkCleartext",
                                "9-NewCredentials",
                                "10-RemoteInteractive",
                                "11-CachedInteractive"
                            ],
                            "supportedValuesKql": null,
                            "valuesKql": null,
                            "name": "Logon Types",
                            "description": "Include only selected logon types in anomaly results.",
                            "sequenceNumber": 0,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.03",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/622844c2-fc11-4efc-91e6-c05b06ab3008')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/622844c2-fc11-4efc-91e6-c05b06ab3008')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "622844c2-fc11-4efc-91e6-c05b06ab3008",
                "displayName": "(Preview) Detect machine generated network beaconing behavior",
                "enabled": true,
                "tactics": [
                    "CommandAndControl"
                ],
                "anomalyVersion": "1.0.5",
                "techniques": [
                    "T1001",
                    "T1008",
                    "T1071",
                    "T1090",
                    "T1095",
                    "T1102",
                    "T1104",
                    "T1132",
                    "T1205",
                    "T1568",
                    "T1571",
                    "T1572",
                    "T1573"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "10",
                            "maximum": "1000",
                            "value": "25",
                            "name": "Degree of source IPs",
                            "description": "Suppress anomalies when degree of source IPs is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "10",
                            "maximum": "1000",
                            "value": "30",
                            "name": "Daily event count threshold",
                            "description": "Suppress anomalies when daily event count is less than the chosen value",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "10",
                            "maximum": "1000",
                            "value": "60",
                            "name": "Time delta threshold in seconds",
                            "description": "Suppress anomalies when time delta in seconds between network connections is less than the chosen value",
                            "sequenceNumber": 3,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "50",
                            "maximum": "100",
                            "value": "75",
                            "name": "Percent beaconing threshold",
                            "description": "Generate an anomaly when percent beaconing is greater than the chosen value",
                            "sequenceNumber": 4,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/b783df9c-4088-452e-a791-0c4fca47a109')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/b783df9c-4088-452e-a791-0c4fca47a109')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "b783df9c-4088-452e-a791-0c4fca47a109",
                "displayName": "(Preview) Domain generation algorithm (DGA) on DNS domains",
                "enabled": true,
                "tactics": [
                    "CommandAndControl"
                ],
                "anomalyVersion": "1.0.4",
                "techniques": [
                    "T1568"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": [
                        {
                            "prioritize": null,
                            "exclude": ".lan, .home",
                            "dataType": "string",
                            "name": "Top level domain",
                            "description": "Give comma separated TLDs to exclude from source data within double quotes, example: \".lan, .home\"",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "thresholdObservations": [
                        {
                            "minimum": "0.0",
                            "maximum": "1.0",
                            "value": "0.9",
                            "name": "Score",
                            "description": "Generate an anomaly when the anomaly score is greater than or equal to the chosen value.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/d4f9d54b-6dec-4655-8631-0fa8d4954fea')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/d4f9d54b-6dec-4655-8631-0fa8d4954fea')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "d4f9d54b-6dec-4655-8631-0fa8d4954fea",
                "displayName": "(Preview) Domain Reputation Palo Alto anomaly",
                "enabled": true,
                "tactics": [
                    "CommandAndControl"
                ],
                "anomalyVersion": "1.0.3",
                "techniques": [
                    "T1568"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.99",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/23850aa1-37d3-4b4b-9f39-4ebf5feb59fd')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/23850aa1-37d3-4b4b-9f39-4ebf5feb59fd')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "23850aa1-37d3-4b4b-9f39-4ebf5feb59fd",
                "displayName": "(Preview) Excessive data transfer anomaly",
                "enabled": true,
                "tactics": [
                    "Exfiltration"
                ],
                "anomalyVersion": "1.0.5",
                "techniques": [
                    "T1011",
                    "T1029",
                    "T1030",
                    "T1041",
                    "T1011",
                    "T1537",
                    "T1567"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": [
                        {
                            "supportedValues": [
                                "Akamai",
                                "Aruba Networks",
                                "Check Point",
                                "Dell",
                                "Forcepoint",
                                "Fortinet",
                                "McAfee",
                                "Palo Alto Networks",
                                "SonicWall",
                                "Trend Micro",
                                "Vectra Networks",
                                "Zscaler"
                            ],
                            "supportedValuesKql": null,
                            "value": "Palo Alto Networks",
                            "name": "Device vendor",
                            "description": "Select device vendor reporting network connection logs to CommonSecurityLog",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "1",
                            "maximum": "10000",
                            "value": "1",
                            "name": "Hourly data transfer threshold in MB",
                            "description": "Suppress anomalies when hourly data transfered (in MB) per hour is less than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": ".98",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/06107abb-1b68-4fdc-841b-8a1ff9301467')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/06107abb-1b68-4fdc-841b-8a1ff9301467')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "06107abb-1b68-4fdc-841b-8a1ff9301467",
                "displayName": "(Preview) Excessive Downloads via Palo Alto GlobalProtect",
                "enabled": true,
                "tactics": [
                    "Exfiltration"
                ],
                "anomalyVersion": "1.0.6",
                "techniques": [
                    "T1030",
                    "T1041",
                    "T1011",
                    "T1567",
                    "T1029",
                    "T1537"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.87",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 0,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/d0bd9611-2fc1-42cb-af4e-793b6f28ba92')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/d0bd9611-2fc1-42cb-af4e-793b6f28ba92')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "d0bd9611-2fc1-42cb-af4e-793b6f28ba92",
                "displayName": "(Preview) Excessive upload via Palo Alto GlobalProtect",
                "enabled": true,
                "tactics": [
                    "Exfiltration"
                ],
                "anomalyVersion": "1.0.6",
                "techniques": [
                    "T1030",
                    "T1041",
                    "T1011",
                    "T1567",
                    "T1029",
                    "T1537"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.87",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 0,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/8546330c-e1fb-422a-9388-5c09e9a8f4ca')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/8546330c-e1fb-422a-9388-5c09e9a8f4ca')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "8546330c-e1fb-422a-9388-5c09e9a8f4ca",
                "displayName": "(Preview) Login from an unusual region via Palo Alto GlobalProtect account logins",
                "enabled": true,
                "tactics": [
                    "InitialAccess",
                    "CredentialAccess",
                    "LateralMovement"
                ],
                "anomalyVersion": "1.0.0",
                "techniques": [
                    "T1133"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.8",
                            "name": "Score",
                            "description": "Generate an anomaly when a region rarity score is less than the threshold.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "2",
                            "maximum": "100",
                            "value": "100",
                            "name": "Minimum users per region",
                            "description": "whitelist an anomaly if the number of users from a rare region is greater than this limit.",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/03401f05-5c45-4f2d-9295-092764090e02')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/03401f05-5c45-4f2d-9295-092764090e02')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "03401f05-5c45-4f2d-9295-092764090e02",
                "displayName": "(Preview) Multi-region logins in a single day via Palo Alto GlobalProtect",
                "enabled": true,
                "tactics": [
                    "InitialAccess",
                    "DefenseEvasion"
                ],
                "anomalyVersion": "2.0.0",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": [
                        {
                            "supportedValues": [
                                "Yes",
                                "No"
                            ],
                            "supportedValuesKql": null,
                            "value": "Yes",
                            "name": "Use region adjacency",
                            "description": "Suppress anomalies originated from two adjacent regions.",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "2",
                            "maximum": "10",
                            "value": "2",
                            "name": "Minimum daily regions for anomaly",
                            "description": "Generate an anomaly when a user logs in from this many or more regions in a day",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/af7fd11a-f305-44e1-8f46-f31580a15eab')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/af7fd11a-f305-44e1-8f46-f31580a15eab')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "af7fd11a-f305-44e1-8f46-f31580a15eab",
                "displayName": "(Preview) Potential data staging",
                "enabled": true,
                "tactics": [
                    "Collection"
                ],
                "anomalyVersion": "1.0.0",
                "techniques": [
                    "T1074"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": [
                        {
                            "prioritize": null,
                            "exclude": "app@sharepoint,user@example.com",
                            "dataType": "string",
                            "name": "User allowlist",
                            "description": "Enter comma separated userids to be suppressed while triggering anomalies. This should be within double quotes and is case insensitive, example: \"user@exmaple.com, app@sharepoint\"",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "thresholdObservations": [
                        {
                            "minimum": "10",
                            "maximum": "100",
                            "value": "25",
                            "name": "Number of distinct files dowloaded per day",
                            "description": "Suppress anomalies when daily number of distinct files downloaded per day is less than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "2",
                            "maximum": "10",
                            "value": "3",
                            "name": "Number of standard deviations",
                            "description": "Triggers anomalies when number of standard deviations is greater than the chosen value",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/25bf2f45-1cf0-47d2-b394-a7b331d707b3')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/25bf2f45-1cf0-47d2-b394-a7b331d707b3')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "25bf2f45-1cf0-47d2-b394-a7b331d707b3",
                "displayName": "(Preview) Suspicious geography change in Palo Alto GlobalProtect account logins",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "2.0.0",
                "techniques": [
                    "T1133",
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": [
                        {
                            "supportedValues": [
                                "Yes",
                                "No"
                            ],
                            "supportedValuesKql": null,
                            "value": "Yes",
                            "name": "Use region adjacency",
                            "description": "Suppress anomalies originated from two adjacent regions.",
                            "sequenceNumber": 0,
                            "rerun": "RerunAlways"
                        },
                        {
                            "supportedValues": [
                                "Yes",
                                "No"
                            ],
                            "supportedValuesKql": null,
                            "value": "No",
                            "name": "Check for matching device",
                            "description": "Suppress anomalies which are originated from the same device.",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": null,
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/543c9254-eb6f-4fdd-858d-783e0e3d5cb9')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/543c9254-eb6f-4fdd-858d-783e0e3d5cb9')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "543c9254-eb6f-4fdd-858d-783e0e3d5cb9",
                "displayName": "(Preview) Suspicious number of protected documents accessed",
                "enabled": true,
                "tactics": [
                    "Collection"
                ],
                "anomalyVersion": "1.0.3",
                "techniques": [
                    "T1530",
                    "T1213",
                    "T1005",
                    "T1039",
                    "T1114"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": [
                        {
                            "prioritize": null,
                            "exclude": ".msg,.jpg,.txt",
                            "dataType": "string",
                            "name": "File extension",
                            "description": "Give comma separated file extension to exclude from source data, for example: .txt,.jpg,.mp4",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.9",
                            "name": "Score",
                            "description": "Generate an anomaly when the error percentile is greater than chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/30dea201-74da-4141-8d21-8a18f0861d60')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/30dea201-74da-4141-8d21-8a18f0861d60')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "30dea201-74da-4141-8d21-8a18f0861d60",
                "displayName": "(Preview) Suspicious volume of AWS cloud trail logs events of group user account by EventTypeName",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.0.1",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.02",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/b40a7a5b-5d39-46fe-a79e-2acdb38e1ce7')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/b40a7a5b-5d39-46fe-a79e-2acdb38e1ce7')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "b40a7a5b-5d39-46fe-a79e-2acdb38e1ce7",
                "displayName": "(Preview) Suspicious volume of failed login attempts to AWS Console by each group user account",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.0.0",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.01",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/e7277475-4e31-41c7-9997-0b8b3d7f00cd')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/e7277475-4e31-41c7-9997-0b8b3d7f00cd')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "e7277475-4e31-41c7-9997-0b8b3d7f00cd",
                "displayName": "(Preview) Suspicious volume of failed login attempts to AWS Console by each source IP address",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.0.0",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.01",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/9c712bb2-08dc-44d3-b66b-af154dfc1c4f')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/9c712bb2-08dc-44d3-b66b-af154dfc1c4f')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "9c712bb2-08dc-44d3-b66b-af154dfc1c4f",
                "displayName": "(Preview) Suspicious volume of logins to computer",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.2.6",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.07",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/9c27cee8-0a33-4abe-8683-212c0a98fc28')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/9c27cee8-0a33-4abe-8683-212c0a98fc28')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "9c27cee8-0a33-4abe-8683-212c0a98fc28",
                "displayName": "(Preview) Suspicious volume of logins to computer with elevated token",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.0.4",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.1",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/200f05a2-db6e-4ff7-be83-bbc30b44755f')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/200f05a2-db6e-4ff7-be83-bbc30b44755f')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "200f05a2-db6e-4ff7-be83-bbc30b44755f",
                "displayName": "(Preview) Suspicious volume of logins to user account",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.2.6",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.07",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/29094df8-e0c7-4475-a74c-bda74a07affb')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/29094df8-e0c7-4475-a74c-bda74a07affb')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "29094df8-e0c7-4475-a74c-bda74a07affb",
                "displayName": "(Preview) Suspicious volume of logins to user account by logon types",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.0.6",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.03",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/a3863d8b-8be1-4f52-8ba2-d6cec98b606b')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/a3863d8b-8be1-4f52-8ba2-d6cec98b606b')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "a3863d8b-8be1-4f52-8ba2-d6cec98b606b",
                "displayName": "(Preview) Suspicious volume of logins to user account with elevated token",
                "enabled": true,
                "tactics": [
                    "InitialAccess"
                ],
                "anomalyVersion": "1.0.5",
                "techniques": [
                    "T1078"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": "0.7",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "NotRequired"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/213252f1-497c-4124-91da-6cb43902d5b1')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/213252f1-497c-4124-91da-6cb43902d5b1')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "213252f1-497c-4124-91da-6cb43902d5b1",
                "displayName": "(Preview) Unusual external firewall alarm detected",
                "enabled": true,
                "tactics": [
                    "Discovery",
                    "CommandAndControl"
                ],
                "anomalyVersion": "1.0.4",
                "techniques": [
                    "T1046",
                    "T1135",
                    "T1071",
                    "T1095",
                    "T1571"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "5",
                            "maximum": "15",
                            "value": "7",
                            "name": "Number of distinct signatures in a day",
                            "description": "Triggers anomalies when daily signatures triggered is more than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/fc1b7e7a-bc24-42c3-ad67-5c76c8fcb2d6')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/fc1b7e7a-bc24-42c3-ad67-5c76c8fcb2d6')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "fc1b7e7a-bc24-42c3-ad67-5c76c8fcb2d6",
                "displayName": "(Preview) Unusual mass downgrade AIP label",
                "enabled": true,
                "tactics": [
                    "Collection"
                ],
                "anomalyVersion": "1.0.3",
                "techniques": [
                    "T1530",
                    "T1213",
                    "T1005",
                    "T1039",
                    "T1114"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": null,
                    "prioritizeExcludeObservations": [
                        {
                            "prioritize": null,
                            "exclude": ".txt,.jpg,.mp4",
                            "dataType": "string",
                            "name": "File extension",
                            "description": "Give comma separated file extension to exclude from source data within double quotes, example: \".txt,.jpg,.mp4\"",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "thresholdObservations": [
                        {
                            "minimum": "5",
                            "maximum": "100",
                            "value": "10",
                            "name": "Minimum number of downgrades",
                            "description": "Generate an anomaly when number of downgrade label is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/ae9128e8-2740-4b62-8bde-54e62b183fca')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/ae9128e8-2740-4b62-8bde-54e62b183fca')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "ae9128e8-2740-4b62-8bde-54e62b183fca",
                "displayName": "(Preview) Unusual network communication on commonly used ports",
                "enabled": true,
                "tactics": [
                    "Exfiltration",
                    "CommandAndControl"
                ],
                "anomalyVersion": "1.0.5",
                "techniques": [
                    "T1030",
                    "T1071"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": [
                        {
                            "supportedValues": [
                                "Palo Alto Networks",
                                "Fortinet",
                                "Check Point"
                            ],
                            "supportedValuesKql": null,
                            "value": "Palo Alto Networks",
                            "name": "Device vendor",
                            "description": "Select device vendor of network connection logs from CommonSecurityLog",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "1",
                            "maximum": "100",
                            "value": "25",
                            "name": "Daily data transfer threshold in MB",
                            "description": "Suppress anomalies when daily data transfered (in MB) per hour is less than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "2",
                            "maximum": "10",
                            "value": "3",
                            "name": "Number of standard deviations",
                            "description": "Triggers anomalies when number of standard deviations is greater than the chosen value",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/95514e77-1b23-4f05-817c-ae363c53aad3')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/95514e77-1b23-4f05-817c-ae363c53aad3')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "95514e77-1b23-4f05-817c-ae363c53aad3",
                "displayName": "(Preview) Unusual network volume anomaly",
                "enabled": true,
                "tactics": [
                    "Exfiltration"
                ],
                "anomalyVersion": "1.0.4",
                "techniques": [
                    "T1030"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": [
                        {
                            "supportedValues": [
                                "Akamai",
                                "Aruba Networks",
                                "Check Point",
                                "Dell",
                                "Forcepoint",
                                "Fortinet",
                                "McAfee",
                                "Palo Alto Networks",
                                "SonicWall",
                                "Trend Micro",
                                "Vectra Networks",
                                "Zscaler"
                            ],
                            "supportedValuesKql": null,
                            "value": "Palo Alto Networks",
                            "name": "Device vendor",
                            "description": "Select device vendor reporting network connection logs to CommonSecurityLog",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "10",
                            "maximum": "10000",
                            "value": "10",
                            "name": "Hourly event count threshold",
                            "description": "Suppress anomalies when hourly event count is less than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "0",
                            "maximum": "1",
                            "value": ".98",
                            "name": "Score",
                            "description": "Generate an anomaly when score is greater than the chosen value",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        },
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/1f6d7abe-2cb7-4a4c-aeca-91fe6bfad0b2')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/1f6d7abe-2cb7-4a4c-aeca-91fe6bfad0b2')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Anomaly",
            "apiVersion": "2021-09-01-preview",
            "properties": {
                "alertRuleTemplateName": "1f6d7abe-2cb7-4a4c-aeca-91fe6bfad0b2",
                "displayName": "(Preview) Unusual web traffic detected with IP in URL path",
                "enabled": true,
                "tactics": [
                    "InitialAccess",
                    "CommandAndControl"
                ],
                "anomalyVersion": "1.0.3",
                "techniques": [
                    "T1189",
                    "T1071"
                ],
                "frequency": "P1D",
                "ruleStatus": "Production",
                "isDefaultRule": true,
                "anomalyRuleVersion": 0,
                "customizableObservations": {
                    "multiSelectObservations": null,
                    "singleSelectObservations": [
                        {
                            "supportedValues": [
                                "Palo Alto Networks",
                                "Fortinet",
                                "Zscaler",
                                "Check Point"
                            ],
                            "supportedValuesKql": null,
                            "value": "Palo Alto Networks",
                            "name": "Device vendor",
                            "description": "Select device vendor of network connection logs from CommonSecurityLog",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "prioritizeExcludeObservations": null,
                    "thresholdObservations": [
                        {
                            "minimum": "10",
                            "maximum": "1000",
                            "value": "25",
                            "name": "Degree of source IPs",
                            "description": "Suppress anomalies when the number of source IPs in a day accessing the URL is greater than the chosen value",
                            "sequenceNumber": 1,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "10",
                            "maximum": "1000",
                            "value": "30",
                            "name": "Daily web requests threshold",
                            "description": "Suppress anomalies when the number of daily web requests is less than the chosen value",
                            "sequenceNumber": 2,
                            "rerun": "RerunAlways"
                        },
                        {
                            "minimum": "1",
                            "maximum": "25",
                            "value": "4",
                            "name": "Number of distinct URLs for the destination IP",
                            "description": "Suppress anomalies when number of distinct URLs are less than the chosen value",
                            "sequenceNumber": 3,
                            "rerun": "RerunAlways"
                        }
                    ],
                    "singleValueObservations": null
                }
            }
        }
    ]
}